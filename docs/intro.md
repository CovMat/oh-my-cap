## intro

### 流程介绍

gCAP 的流程是三个环节：数据预处理、格林函数的计算和反演。

#### 数据预处理

数据预处理是要把地震数据经过一些处理，以符合 gCAP 的要求。具体要做哪些处理，后面会介绍到。

现在就需要知道的是 gCAP 要求数据必须包含的内容有：地震的波形记录、地震仪的仪器响应文件、地震事件的发震时刻、震中位置和震源深度。
在这里需要着重提醒的是没有经过去仪器响应处理的 SAC 文件是不能使用的。所以，如果获得的 SAC 文件没有去仪器响应，又没有得到地震仪的仪器响应文件，那么无法展开工作。

#### 格林函数的计算

格林函数表示 t_0 时刻作用在 r_0 处的单位力矢量在 t 时刻、r 处产生的位移矢量。地震的波形记录在去除了仪器响应之后是震源时间函数和格林函数的卷积。
计算出来的格林函数，和理论的震源时间函数叠加后才能与实际的波形记录相比较。所以正确计算格林函数是关键的一步。

#### 反演

gCAP 会把 Pnl 波和面波的波形“剪开”，分开反演，以避免因面波能量过大压制了前面 Pnl 波对反演结果的贡献。
需要说明的是，一些资料说 CAP 使用的是横波，这是因为 CAP 按照时间窗口截取波形的时候是横波的时间窗口，但是 CAP 方法处理的地震一般是近震甚至是地方震，面波和横波是混在一起的，面波振幅更大所以实际使用的是面波的波形。

### 快速实现例子

我们将用一个例子来说明从原始的seed文件开始经数据预处理、格林函数计算和最后的反演的细节。在这之前，请用我们准备好的脚本把例子快速地重做一遍以验证你的安装。

#### 数据预处理
在 `example/` 下，运行 `process.pl`：

    perl process.pl 20080418093658

#### 计算格林函数
在 `Glib/hk/`下，运行 `run.pl`：

    perl run.pl

#### 反演
在 `/example/` 下执行命令：

    perl weight.pl 20080418093658
    cap.pl -H0.2 -P0.3 -S5/10/0 -T35/70 -D2/1/0.5 -C0.05/0.3/0.02/0.1 -W1 -X10 -Mhk_15/5.0 20080418093658