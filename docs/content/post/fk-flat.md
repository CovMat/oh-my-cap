+++
date = 2018-02-06
title = "FK 展平变换的说明"
author = "王亮"
[menu.main]
  parent = "blog"
  weight = 1
+++

本来，FK 计算格林函数要求震源深度和地层界面深度不能一样，但是，实际计算时，如果用了展平变换，深度即使一样，程序也不会报错。这篇文章讨论这个问题。

<!--more-->

## 什么是展平变换

展平变换就是水平层状模型和球对称层状模型间的坐标转换公式。有了展平变换公式，在水平层状模型中得到的结论就可以轻易推广到球对称层状模型中了。

## 为什么 FK 不允许震源深度和地层界面深度一样

因为在计算的时候，若震源位于地层界面上，会出现参数的间断。如果做一个试验，震源在界面上，FK 程序会中断。

## 为什么使用了展平变换，震源在地层界面上，FK 程序不会中断

因为在 fk.pl 中，震源深度和模型厚度用的是不同的展平变换公式，震源 5km 展平之后变成了 4.999km，模型厚度 5km 展平之后变成了 4.998km，所以交给 fk 二进制程序的是不一样的。
